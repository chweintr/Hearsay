<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Room 412 â€” HEARSAY</title>
    <meta name="description" content="Stories through the door. A HEARSAY experience.">
    
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,600;1,400;1,500&family=Cinzel:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Simli Widget SDK -->
    <script src="https://app.simli.com/simli-widget/index.js" defer></script>
</head>
<body>
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         LANDING PAGE - Character Selection
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="landing-page" class="page active">
        <!-- Video stack - both videos in same container for blend mode to work -->
        <div class="video-blend-stack">
            <video id="landing-video" class="landing-bg-video" autoplay muted playsinline>
                <source src="assets/videos/The_Knock_Background.mp4" type="video/mp4">
            </video>
            <!-- Animated text overlay - same parent so screen blend works -->
            <video id="animated-text-video" class="animated-text-video" autoplay loop muted playsinline>
                <source src="assets/videos/Animated_Text.mp4" type="video/mp4">
            </video>
        </div>
        <div class="landing-overlay"></div>
        
        <div class="landing-content">
            <div class="landing-spacer"></div>
            
            <div class="character-gallery" id="character-gallery">
                <!-- Characters injected by JS -->
            </div>
            
            <div class="menu-buttons">
                <button id="about-btn" class="menu-btn">About</button>
                <button id="store-btn" class="menu-btn">Sensory Packs</button>
            </div>
        </div>
    </div>
    
    <!-- Coming Soon Modal -->
    <div id="coming-soon-modal" class="modal hidden">
        <div class="modal-content coming-soon-content">
            <button class="modal-close" onclick="document.getElementById('coming-soon-modal').classList.add('hidden')">&times;</button>
            <h2><span class="coming-soon-name">This character</span> is not yet available</h2>
            <p>The hotel is still preparing their room. Leave your details and we'll let you know when they're ready to receive visitors.</p>
            <form class="waitlist-form" onsubmit="event.preventDefault(); submitWaitlist(this);">
                <input type="email" name="email" placeholder="your@email.com" required>
                <button type="submit">Notify Me</button>
            </form>
        </div>
    </div>
    
    <!-- Store Modal -->
    <div id="store-modal" class="modal hidden">
        <div class="modal-content store-content">
            <button class="modal-close" onclick="document.getElementById('store-modal').classList.add('hidden')">&times;</button>
            <h2>Sensory Packs</h2>
            <p class="store-tagline">Physical artifacts from the hotel. Things you can hold, smell, taste. The fiction made tangible.</p>
            
            <div class="store-grid" id="store-grid">
                <!-- Products injected by JS -->
            </div>
            
            <p class="store-notice">
                <strong>THE KNOCK</strong> brought to you by <em>Past Presence</em> is currently in development.<br>
                Leave your email to be notified when the hotel opens its doors.
            </p>
            <form class="waitlist-form" onsubmit="event.preventDefault(); submitWaitlist(this);">
                <input type="email" name="email" placeholder="your@email.com" required>
                <button type="submit">Join Waitlist</button>
            </form>
        </div>
    </div>
    
    <!-- About Modal -->
    <div id="about-modal" class="modal hidden">
        <div class="modal-content">
            <button class="modal-close" id="about-close">Ã—</button>
            <div class="about-text">
                <p class="about-lead">Someone is at your door.</p>
                <p>They have something to tell you. Whether you believe them is up to you.</p>
                <p>HEARSAY is a series of conversational experiences. No puzzles. No right answers. Just unreliable narrators and the stories they tell.</p>
                <p class="about-tagline">Somewhere between a novel, a play, a movie, a mystery, a dream, a confession, and a communion.</p>
            </div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         EXPERIENCE PAGE - Peephole Interface
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="experience-page" class="page">
        <div id="hearsay-app">
            <!-- Layer 0: Hallway Background - always visible, full screen -->
            <div id="layer-background" class="video-layer">
                <video id="video-hallway" loop muted playsinline autoplay>
                    <source src="assets/videos/Background_1.mp4" type="video/mp4">
                </video>
            </div>

            <!-- Face Container: shared mount for walkup videos AND Simli -->
            <!-- This is centered in the peephole, sized to fit the opening -->
            <div id="face-container">
                <!-- Layer 1: Transition/Walkup Videos -->
                <div id="layer-transition" class="face-layer hidden">
                    <video id="video-transition" muted playsinline></video>
                </div>

                <!-- Layer 2: Simli Widget -->
                <div id="layer-simli" class="face-layer hidden">
                    <div id="simli-mount"></div>
                </div>
            </div>

            <!-- Layer 3: Peephole Frame -->
            <div id="layer-peephole" class="overlay-layer">
                <div id="peephole-mask">
                    <div id="peephole-glass"></div>
                </div>
            </div>

            <!-- Layer 4: Peephole overlay - full screen with transparent center -->
            <div id="layer-door-overlay" class="overlay-layer">
                <img src="assets/images/overlay.png" alt="" id="peephole-overlay">
            </div>

            <!-- Vignette -->
            <div id="vignette-overlay"></div>
        </div>

        <!-- Experience Controls -->
        <div id="experience-controls" class="experience-ui">
            <button id="btn-dismiss" class="btn-dismiss" disabled>Send Away</button>
            <button id="btn-back" class="btn-back">â† Back</button>
        </div>

        <!-- Character info overlay -->
        <div id="character-info" class="character-info">
            <span id="current-character-name"></span>
            <span id="current-character-role"></span>
        </div>
    </div>

    <!-- Audio elements -->
    <audio id="audio-knock" preload="auto">
        <source src="assets/sounds/door_knocks/knock_hotel_1.wav" type="audio/wav">
    </audio>
    
    <!-- Ambient track - single loop -->
    <audio id="ambient-main" class="ambient-track" loop preload="auto">
        <source src="assets/sounds/hotel_hallway_subtle_3a.wav" type="audio/wav">
    </audio>
    
    <!-- Music track - single loop -->
    <audio id="music-main" class="music-track" loop preload="auto">
        <source src="assets/sounds/MataZ.wav" type="audio/wav">
    </audio>
    
    <!-- Audio Controls -->
    <div id="audio-controls" class="audio-controls">
        <button id="audio-toggle" class="audio-toggle">ğŸ”Š</button>
        <div class="volume-sliders">
            <div class="slider-group">
                <label>Ambient</label>
                <input type="range" id="ambient-volume" min="0" max="100" value="65">
            </div>
            <div class="slider-group">
                <label>Music</label>
                <input type="range" id="music-volume" min="0" max="100" value="15">
            </div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         APPLICATION LOGIC
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <script type="module">
        import { config, characters, platform, experience } from './config.js';
        import { StateMachine } from './state-machine.js';
        import { Compositor } from './compositor.js';
        import { SimliIntegration } from './simli-integration.js';

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // PAGE MANAGEMENT
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        
        const landingPage = document.getElementById('landing-page');
        const experiencePage = document.getElementById('experience-page');
        
        function showLanding() {
            landingPage.classList.add('active');
            experiencePage.classList.remove('active');
        }
        
        function showExperience() {
            landingPage.classList.remove('active');
            experiencePage.classList.add('active');
        }

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // CHARACTER GALLERY
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        
        const gallery = document.getElementById('character-gallery');
        const characterKeys = Object.keys(characters);
        const totalChars = characterKeys.length;
        
        // Orbital positioning - characters arranged around the peephole
        // Start at 120Â° (lower left), go to 420Â° (lower right), avoiding top where title is
        // This creates a horseshoe shape around the bottom/sides
        const startAngle = 120;
        const endAngle = 420; // 420 = 60Â° on the right side
        const angleStep = (endAngle - startAngle) / (totalChars - 1);
        
        characterKeys.forEach((key, index) => {
            const character = characters[key];
            const card = document.createElement('div');
            card.className = 'character-card';
            card.dataset.character = key;
            
            // Add coming_soon class if not ready
            if (character.status === 'coming_soon') {
                card.classList.add('coming-soon');
            }
            
            // Calculate radial position
            const angle = startAngle + (index * angleStep);
            card.style.setProperty('--angle', `${angle}deg`);
            card.dataset.angle = angle;
            
            // Check if we have a preview video
            const videoSrc = character.previewVideo || 
                (character.idleToActive && character.idleToActive.length > 0 ? character.idleToActive[0] : null);
            
            card.innerHTML = `
                <div class="character-circle">
                    ${videoSrc ? `
                        <video class="character-preview" loop muted playsinline autoplay>
                            <source src="${videoSrc}" type="video/mp4">
                        </video>
                    ` : `
                        <div class="character-placeholder">
                            <span class="placeholder-initial">${character.name.charAt(0)}</span>
                        </div>
                    `}
                    <div class="character-circle-border"></div>
                    ${character.status === 'coming_soon' ? '<div class="coming-soon-badge">Coming Soon</div>' : ''}
                </div>
                <span class="character-name">${character.name}</span>
                <span class="character-role">${character.role}</span>
            `;
            
            card.addEventListener('click', () => {
                if (character.status === 'coming_soon') {
                    showComingSoonModal(character.name);
                } else {
                    enterExperience(key);
                }
            });
            
            // Play video on hover
            const video = card.querySelector('video');
            if (video) {
                video.play().catch(() => {});
            }
            
            gallery.appendChild(card);
        });
        
        // Coming Soon Modal
        function showComingSoonModal(charName) {
            const modal = document.getElementById('coming-soon-modal');
            const nameEl = modal.querySelector('.coming-soon-name');
            if (nameEl) nameEl.textContent = charName;
            modal.classList.remove('hidden');
        }

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // CORE SYSTEMS
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        
        const stateMachine = new StateMachine();
        const compositor = new Compositor(stateMachine);
        const simli = new SimliIntegration(stateMachine, config);
        
        // UI Elements
        const dismissBtn = document.getElementById('btn-dismiss');
        const backBtn = document.getElementById('btn-back');
        const charNameEl = document.getElementById('current-character-name');
        const charRoleEl = document.getElementById('current-character-role');

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // ENTER EXPERIENCE
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        
        function enterExperience(characterKey) {
            const character = characters[characterKey];
            if (!character) return;
            
            // Update character info display
            charNameEl.textContent = character.name;
            charRoleEl.textContent = character.role;
            
            // Switch to experience view
            showExperience();
            
            // Start the experience - summon character
            setTimeout(() => {
                stateMachine.summonCharacter(characterKey);
            }, 500);
        }

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // CONTROLS
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        
        dismissBtn.addEventListener('click', () => {
            if (stateMachine.currentState === 'active') {
                stateMachine.dismissCharacter();
            }
        });
        
        backBtn.addEventListener('click', () => {
            // If in conversation, dismiss first
            if (stateMachine.currentState === 'active') {
                stateMachine.dismissCharacter();
            }
            // Go back to landing after a moment
            setTimeout(() => {
                stateMachine.reset();
                showLanding();
            }, 300);
        });

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // STATE UPDATES
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        
        stateMachine.on('stateChange', ({ to }) => {
            dismissBtn.disabled = to !== 'active';
        });
        
        stateMachine.on('characterDismissed', () => {
            // Return to landing after character leaves
            setTimeout(() => {
                showLanding();
            }, 500);
        });

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // INIT
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // ABOUT MODAL
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        
        const aboutBtn = document.getElementById('about-btn');
        const aboutModal = document.getElementById('about-modal');
        const aboutClose = document.getElementById('about-close');
        
        aboutBtn?.addEventListener('click', () => {
            aboutModal?.classList.remove('hidden');
        });
        
        aboutClose?.addEventListener('click', () => {
            aboutModal?.classList.add('hidden');
        });
        
        aboutModal?.addEventListener('click', (e) => {
            if (e.target === aboutModal) {
                aboutModal.classList.add('hidden');
            }
        });

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // STORE MODAL
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        
        const storeBtn = document.getElementById('store-btn');
        const storeModal = document.getElementById('store-modal');
        const storeGrid = document.getElementById('store-grid');
        
        // Sensory Pack Products - 9 characters + Hotel sampler
        const storeProducts = [
            {
                id: 'tane',
                name: 'TANE â€” "Live Fast"',
                tagline: 'We\'ll show you what you\'re hiding.',
                price: '$35',
                images: [
                    'assets/images/Sensory Packs/Sensory_Pack_Tane_4.png',
                    'assets/images/Sensory Packs/Sensory_PAck_Tane.png',
                    'assets/images/Sensory Packs/Sensory_Pack_Tane_2.png'
                ],
                image: 'assets/images/Sensory Packs/Sensory_Pack_Tane_4.png',
                featured: true,
                description: 'Fluorescent packaging. Neon orange, electric pink. Figures running, flexing, conquering. Nightclub bathroom energy.',
                contents: [
                    'Energy drink powder ("MIX WITH VODKA OR REGRET")',
                    'Temporary tattoo sheet â€” horse, "LONG ODDS", anatomical heart',
                    '"PULSE" cologne â€” synthetic musk, overconfidence',
                    '"THE STARTING GATE" matchbook',
                    'Scratch-off fortune cards',
                    'Submission card â€” "Send us your face." (Trust us.)',
                    'Polaroids from an evening you don\'t remember'
                ],
                cocktail: 'Energy drink vodka shot',
                virgin: 'Energy drink straight'
            },
            {
                id: 'wire',
                name: 'WIRE â€” "The Sixth Floor"',
                tagline: 'For patience. Steep until you understand.',
                price: '$35',
                image: null,
                description: 'Muted earth tones. Brown paper, horse racing stamps, wax seal. Packed in dried tea leaves.',
                contents: [
                    'Kawakawa & mÄnuka honey tea blend',
                    'Vintage sugar cubes in tin',
                    'Racing form guide â€” hand-annotated',
                    'Sandalwood & petrichor scent',
                    'Brass key "614"',
                    'Huia feather replica'
                ],
                cocktail: 'Hot Toddy with mÄnuka honey',
                virgin: 'Tea-based toddy'
            },
            {
                id: 'marisol',
                name: 'MARISOL â€” "The Inheritance"',
                tagline: 'What he knew. What he didn\'t tell me.',
                price: '$35',
                image: null,
                description: 'Matte black, blind embossed. Burgundy wax seal with "V" for Vance.',
                contents: [
                    'Brass key â€” room number scratched off',
                    'Wax seal kit with Vance crest',
                    'Two scent vials: "HER" and "THE DISGUISE"',
                    'Theatrical false lashes',
                    'Redacted legal document',
                    'Polaroid â€” figure in fourth floor window'
                ],
                cocktail: 'Dark & Stormy',
                virgin: 'Ginger lime spritz'
            },
            {
                id: 'eddie',
                name: 'EDDIE â€” "The Night Kitchen"',
                tagline: 'For when you can\'t sleep. Make this. Feel better.',
                price: '$35',
                image: null,
                description: 'Papel picado-style tissue. Hot pink and marigold. Smells of cinnamon and chiles.',
                contents: [
                    'Mole spice blend in clay pot',
                    'Tamarind candies (Pulparindo style)',
                    'LoterÃ­a cards: La Luna, El CorazÃ³n, La Muerte',
                    'Mexican vanilla from Papantla',
                    'Kitchen scent â€” tortilla, woodsmoke, cumin',
                    'Champurrado recipe card'
                ],
                cocktail: 'Michelada',
                virgin: 'Virgin michelada'
            },
            {
                id: 'dotty',
                name: 'DOTTY â€” "Room 308"',
                tagline: 'She was somebody once.',
                price: '$35',
                image: null,
                description: 'Vintage wallpaper. Cabbage roses. Dusty pink silk ribbon. Smells of gin and face powder.',
                contents: [
                    'Horehound drops in dented silver tin',
                    'Mini bottle labeled "MEDICINAL PURPOSES"',
                    'Gin botanical sachet',
                    'Lipstick-stained cocktail napkin',
                    'Tarnished compact mirror, initialed "D.M."',
                    'B&W photograph â€” beautiful woman, 1960s'
                ],
                cocktail: 'Gin Fizz',
                virgin: 'Botanical lemonade fizz'
            },
            {
                id: 'constance',
                name: 'CONSTANCE â€” "Fourth Floor"',
                tagline: 'Observed. Noted. Filed.',
                price: '$35',
                image: null,
                description: 'Hunter green linen. Debossed botanicals. Smells of libraries and dried flowers.',
                contents: [
                    'Pressed flowers from the hotel garden',
                    'Calling card â€” just her name, no contact',
                    'Green aldehydic perfume sample',
                    'Note: "I know why you\'re here. Do you?"',
                    'Brass magnifying glass',
                    'Vintage bookplate â€” name scratched out'
                ],
                cocktail: 'Pimm\'s Cup',
                virgin: 'Cucumber mint lemonade'
            },
            {
                id: 'priya',
                name: 'PRIYA â€” "Trust Me"',
                tagline: 'What happens at the bar stays at the bar. Mostly.',
                price: '$35',
                image: null,
                description: 'Dark green with white polka dots. Her dress, translated. Arranged with bartender\'s precision.',
                contents: [
                    'Bar towel embroidered "P.R."',
                    'Mismatched cocktail stirrers',
                    'Bitters sampler â€” numbered 1, 2, 3',
                    'Hotel bar matchbook',
                    'Scent: fernet, mezcal, citrus peel',
                    'Ceramic olive (joke or keepsake, unclear)'
                ],
                cocktail: 'The Trust Me â€” fernet & mezcal',
                virgin: 'Bitter botanical soda with grapefruit'
            },
            {
                id: 'lenny',
                name: 'LENNY â€” "The Comedian"',
                tagline: 'Thank you, you\'ve been a beautiful audience.',
                price: '$35',
                image: null,
                description: 'Rumpled packaging. Coffee stain. Half-peeled club stickers. "FRAGILE" stamp.',
                contents: [
                    '"LAUGH TRACK LOUNGE" matchbook',
                    'Cheap breath mints in dented tin',
                    'Mini whiskey bottle (maybe refilled)',
                    'Crumpled setlist â€” "hotel bit â€” too real?"',
                    'Motel soap from "The Restwell"',
                    'Fake business card â€” numbers crossed out'
                ],
                cocktail: 'Irish Coffee',
                virgin: 'Just sad coffee'
            },
            {
                id: 'caleb',
                name: 'CALEB â€” "The Author"',
                tagline: 'I made this. I\'m still not sure why.',
                price: '$35',
                image: null,
                description: 'Kraft paper. Paint smudges. Tag reads "HANDLE WITH CURIOSITY."',
                contents: [
                    'Polaroid â€” author\'s workspace',
                    'Handwritten note about the characters',
                    'Used paintbrush, bristles stained',
                    'Studio scent: linseed oil, turpentine, coffee',
                    'Exhibition postcard',
                    'Blank notebook for your notes'
                ],
                cocktail: 'Bourbon neat',
                virgin: 'Black coffee'
            },
            {
                id: 'hotel',
                name: 'THE HOTEL PACK â€” "Room 412"',
                tagline: 'The Hallway at 3am.',
                price: '$68',
                image: null,
                featured: true,
                description: 'The sampler. Box looks like a hotel door â€” "412" numerals, tiny peephole.',
                contents: [
                    'Room 412 leather key tag',
                    'Do Not Disturb sign (vintage style)',
                    'Hotel matchbook â€” Est. 1943',
                    '"Hallway at 3am" signature scent',
                    'Annotated floor plan with handwritten notes',
                    'Note slipped under door: "We know you\'re in there."',
                    'ONE SAMPLE FROM EACH CHARACTER'
                ],
                cocktail: 'Room 412 Signature â€” amber, bitter, mysterious',
                virgin: 'Bitters and soda with orange'
            }
        ];
        
        // Populate store grid
        storeProducts.forEach(product => {
            const productEl = document.createElement('div');
            productEl.className = 'store-product' + (product.featured ? ' featured' : '');
            productEl.dataset.productId = product.id;
            
            const contentsHtml = product.contents ? 
                `<ul class="product-contents">${product.contents.map(item => `<li>${item}</li>`).join('')}</ul>` : '';
            
            // Image gallery for products with multiple images
            let imageHtml = '';
            if (product.images && product.images.length > 1) {
                imageHtml = `
                    <div class="product-gallery">
                        <img src="${product.images[0]}" alt="${product.name}" class="gallery-main" id="gallery-${product.id}">
                        <div class="gallery-thumbs">
                            ${product.images.map((img, i) => `<img src="${img}" onclick="document.getElementById('gallery-${product.id}').src='${img}'" class="${i===0?'active':''}">`).join('')}
                        </div>
                    </div>
                `;
            } else if (product.image) {
                imageHtml = `<div class="product-image"><img src="${product.image}" alt="${product.name}"></div>`;
            } else {
                imageHtml = `<div class="product-image"><div class="product-placeholder">${product.id === 'hotel' ? 'The Complete Experience' : 'Image Coming'}</div></div>`;
            }
            
            productEl.innerHTML = `
                ${product.featured ? '<div class="featured-badge">âœ¦ Available Now</div>' : ''}
                ${imageHtml}
                <h3 class="product-name">${product.name}</h3>
                <p class="product-tagline">${product.tagline || ''}</p>
                <p class="product-description">${product.description}</p>
                
                <div class="product-details collapsed">
                    <h4>Contains:</h4>
                    ${contentsHtml}
                    <div class="product-cocktails">
                        <span class="cocktail-label">ğŸ¸ ${product.cocktail}</span>
                        <span class="virgin-label">â˜• Virgin: ${product.virgin}</span>
                    </div>
                </div>
                
                <button class="details-toggle" onclick="toggleProductDetails(this)">View Contents â–¼</button>
                
                <div class="product-footer">
                    <span class="product-price">${product.price}</span>
                    <button class="product-btn" onclick="showStoreWaitlist('${product.name}')">Add to Cart</button>
                </div>
            `;
            storeGrid.appendChild(productEl);
        });
        
        // Toggle product details
        window.toggleProductDetails = function(btn) {
            const details = btn.previousElementSibling;
            const isCollapsed = details.classList.contains('collapsed');
            details.classList.toggle('collapsed');
            btn.textContent = isCollapsed ? 'Hide Contents â–²' : 'View Contents â–¼';
        };
        
        storeBtn?.addEventListener('click', () => {
            storeModal?.classList.remove('hidden');
        });
        
        storeModal?.addEventListener('click', (e) => {
            if (e.target === storeModal) {
                storeModal.classList.add('hidden');
            }
        });
        
        // Waitlist submission (placeholder)
        window.submitWaitlist = function(form) {
            const email = form.querySelector('input[name="email"]').value;
            alert(`Thanks! We'll reach out to ${email} when the hotel opens.`);
            form.reset();
            document.querySelectorAll('.modal').forEach(m => m.classList.add('hidden'));
        };
        
        window.showStoreWaitlist = function(productName) {
            alert(`THE KNOCK is gearing up. "${productName}" will be available soon. Leave your email in the form below to be notified!`);
        };

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // AUDIO SYSTEM
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        
        const ambientTracks = document.querySelectorAll('.ambient-track');
        const musicTrack = document.getElementById('music-main');
        const ambientSlider = document.getElementById('ambient-volume');
        const musicSlider = document.getElementById('music-volume');
        const audioToggle = document.getElementById('audio-toggle');
        
        let audioStarted = false;
        let audioMuted = false;
        
        // Set initial volumes
        function updateAmbientVolume(value) {
            const vol = value / 100;
            ambientTracks.forEach(track => {
                track.volume = vol;
            });
        }
        
        function updateMusicVolume(value) {
            const vol = value / 100;
            if (musicTrack) musicTrack.volume = vol;
        }
        
        // Start all audio (must be triggered by user interaction)
        function startAudio() {
            if (audioStarted) return;
            audioStarted = true;
            
            // Start ambient tracks
            ambientTracks.forEach(track => {
                track.volume = ambientSlider.value / 100;
                track.play().catch(e => console.log('Ambient blocked:', e));
            });
            
            // Start music (single track, loops)
            if (musicTrack) {
                musicTrack.volume = musicSlider.value / 100;
                musicTrack.play().catch(e => console.log('Music blocked:', e));
            }
            
            audioMuted = false;
            audioToggle.textContent = 'ğŸ”Š';
            audioToggle.classList.add('playing');
        }
        
        // Toggle mute
        function toggleAudio() {
            if (!audioStarted) {
                startAudio();
                return;
            }
            
            audioMuted = !audioMuted;
            
            // Mute/unmute all audio
            ambientTracks.forEach(track => track.muted = audioMuted);
            if (musicTrack) musicTrack.muted = audioMuted;
            
            audioToggle.textContent = audioMuted ? 'ğŸ”‡' : 'ğŸ”Š';
            audioToggle.classList.toggle('playing', !audioMuted);
        }
        
        // Event listeners
        audioToggle.addEventListener('click', toggleAudio);
        ambientSlider.addEventListener('input', (e) => updateAmbientVolume(e.target.value));
        musicSlider.addEventListener('input', (e) => updateMusicVolume(e.target.value));
        
        // Start audio on first click anywhere on page
        document.body.addEventListener('click', () => {
            if (!audioStarted) startAudio();
        }, { once: true });
        
        // Also try on any touch (mobile)
        document.body.addEventListener('touchstart', () => {
            if (!audioStarted) startAudio();
        }, { once: true });

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // LANDING VIDEO LOOP WITH PAUSE ON FIRST FRAME
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        
        const landingVideo = document.getElementById('landing-video');
        const PAUSE_DURATION = 5000; // 5 seconds pause on first frame
        
        if (landingVideo) {
            // Start paused
            landingVideo.pause();
            landingVideo.currentTime = 0;
            
            // After pause duration, play the video
            setTimeout(() => {
                landingVideo.play();
            }, PAUSE_DURATION);
            
            // When video ends, go back to start and pause again
            landingVideo.addEventListener('ended', () => {
                landingVideo.currentTime = 0;
                landingVideo.pause();
                
                // After pause, play again
                setTimeout(() => {
                    landingVideo.play();
                }, PAUSE_DURATION);
            });
        }

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // INIT
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        
        // Expose for debugging
        window.hearsay = { stateMachine, compositor, simli, config, characters, platform, experience };
        console.log(`${platform.name} â€” ${experience.name} initialized`);
    </script>
</body>
</html>
